
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Problem Set 3</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-04-22"><meta name="DC.source" content="ps3.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Problem Set 3</h1><!--introduction--><pre>Clint Valentine
April 22th 2015
Biomolecular Control and Dynamics
Prof. Anand Asthagiri</pre><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Bistability and Phase Portrait for a First-Order System</a></li><li><a href="#2">Phase Portrait and Stability Analysis of a Linear Second Order System</a></li><li><a href="#3">Complex Eigenvalues</a></li><li><a href="#4">Stability Analysis for a Non-Linear System</a></li></ul></div><h2>Bistability and Phase Portrait for a First-Order System<a name="1"></a></h2><p>The phase portrait of this single state variable system contains a positive feedback as the production of <img src="ps3_eq12258561331126870149.png" alt="$A^{*}$"> will encourage the production of more <img src="ps3_eq12258561331126870149.png" alt="$A^{*}$"> from remaining <img src="ps3_eq05147331747641807187.png" alt="$A$">. The phase portrait will show how this system will move through time. We will plot the entire system in a phase plane <img src="ps3_eq01789755267507024389.png" alt="$\frac{dA^{*}}{dt}$"> vs. <img src="ps3_eq12258561331126870149.png" alt="$A^{*}$"> and whenever the system intersects the y-axis, there is a fixed point.</p><p><img src="ps3_eq04522688322581263470.png" alt="$$&#xA;\frac{dA^{*}}{dt} = \big(stimulus + f\frac{A^{*n}}{K^{n} + A^{*n}}\big)&#xA;(A_{T} - A^{*}) - k_{i}A^{*}&#xA;$$"></p><p>The following code and plots show the system for three stimulus values and two feedback values. The non-trivial fixed points where plotted. The qualitative change in the system for a feedback level of <img src="ps3_eq13353221002459255655.png" alt="$0.4$"> compared to <img src="ps3_eq04460137418213960026.png" alt="$0.3$"> is that there now exists two stable fixed points in the system with no stimulus. This is significant because a system that begins with a higher level of <img src="ps3_eq12258561331126870149.png" alt="$A^{*}$"> can maintain <img src="ps3_eq12258561331126870149.png" alt="$A^{*}$"> production with zero stimulus.</p><p>Another qualitative characteristic that appears is the exaggerated slopes in the phase plane. The rate of <img src="ps3_eq12258561331126870149.png" alt="$A^{*}$"> in the higher feedback level system works harder to maintain the stable fixed points.</p><pre class="codeinput"><span class="comment">% Create colorbrewer for better plotting. Download hex2rgb.m.</span>
cb.black = hex2rgb(<span class="string">'#000000'</span>, 1);cb.grey = hex2rgb(<span class="string">'#999999'</span>, 1);
cb.orange  = hex2rgb(<span class="string">'#E69F00'</span>, 1);cb.turquoise = hex2rgb(<span class="string">'#56B4E9'</span>, 1);
cb.green = hex2rgb(<span class="string">'#009E73'</span>, 1);cb.yellow = hex2rgb(<span class="string">'#F0E442'</span>, 1);
cb.blue = hex2rgb(<span class="string">'#0072B2'</span>, 1);cb.red = hex2rgb(<span class="string">'#D55E00'</span>, 1);

syms <span class="string">a</span> <span class="string">stimulus</span>;

n = 7.0;
K = 0.5;
At = 1.0;
ki = 0.2;
f = [0.3, 0.4];
stim = [0, 0.06, 0.1];

figure(1);
hold <span class="string">on</span>;
axis(<span class="string">'on'</span>);
grid(<span class="string">'on'</span>);

axis([0, 1, -0.2, 0.15])

yL = xlim;
line(yL, [0 0], <span class="string">'color'</span>, cb.grey);  <span class="comment">% x-axis</span>

x = linspace(0, 1, 1000);
feedback = @(stimulus, x) (stimulus(1) + f(1) .* (x.^n) ./ (K^n + x.^n))<span class="keyword">...</span>
    .* (At - x) - (ki .* x);
eqn = (stimulus + f(1) * (a^n) / (K^n + a^n)) * (At - a) - (ki * a) == 0;

y1 = feedback(stim(1), x);
y2 = feedback(stim(2), x);
y3 = feedback(stim(3), x);

roots1 = solve(subs(eqn, stimulus, stim(1)), <span class="string">'a'</span>);
roots2 = solve(subs(eqn, stimulus, stim(2)), <span class="string">'a'</span>);
roots3 = solve(subs(eqn, stimulus, stim(3)), <span class="string">'a'</span>);

h1 = plot(x, y1, x, y2, x, y3);
h2 = plot(roots1(1), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h3 = plot(vpa(roots2(2)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h4 = plot(vpa(roots2(3)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'none'</span>,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h5 = plot(vpa(roots2(4)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h6 = plot(vpa(roots3(2)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);

h = xlabel(<span class="string">'$A^{*}$'</span>, <span class="string">'FontSize'</span>, 16);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = ylabel(<span class="string">'$\frac{dA^{*}}{dt}$'</span>, <span class="string">'FontSize'</span>, 16, <span class="string">'rot'</span>, 0);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = legend([h1(1) h1(2) h1(3) h2 h4], {<span class="string">'Stimulus = 0.00'</span>, <span class="string">'Stimulus = 0.06'</span>,<span class="keyword">...</span>
    <span class="string">'Stimulus = 0.10'</span>, <span class="string">'Stable Fixed Point'</span>, <span class="string">'Unstable Fixed Point'</span>},<span class="keyword">...</span>
    <span class="string">'location'</span>, <span class="string">'northeast'</span>);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = title(<span class="string">'Stimulus Driven Feedback (0.3) for a First Order System'</span>,<span class="keyword">...</span>
    <span class="string">'FontSize'</span>, 12);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);


figure(2);
hold <span class="string">on</span>;
axis(<span class="string">'on'</span>);
grid(<span class="string">'on'</span>);

yL = xlim;
line(yL, [0 0], <span class="string">'color'</span>, cb.grey);  <span class="comment">% x-axis</span>

x = linspace(0, 1, 1000);
feedback = @(stimulus, x) (stimulus(1) + f(2) .* (x.^n) ./<span class="keyword">...</span>
    (K^n + x.^n)) .* (At - x) - (ki .* x);
eqn = (stimulus + f(2) * (a^n) / (K^n + a^n)) * (At - a) - (ki * a) == 0;

y1 = feedback(stim(1), x);
y2 = feedback(stim(2), x);
y3 = feedback(stim(3), x);

roots1 = solve(subs(eqn, stimulus, stim(1)), <span class="string">'a'</span>);
roots2 = solve(subs(eqn, stimulus, stim(2)), <span class="string">'a'</span>);
roots3 = solve(subs(eqn, stimulus, stim(3)), <span class="string">'a'</span>);

h1 = plot(x, y1, x, y2, x, y3);
h2 = plot(roots1(1), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h3 = plot(vpa(roots2(2)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h4 = plot(vpa(roots2(3)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'none'</span>,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h5 = plot(vpa(roots1(2)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'none'</span>,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h6 = plot(vpa(roots1(4)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h7 = plot(vpa(roots2(4)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);
h8 = plot(vpa(roots3(2)), 0, <span class="string">'ro'</span>, <span class="string">'MarkerFaceColor'</span>, cb.yellow,<span class="keyword">...</span>
    <span class="string">'MarkerEdgeColor'</span>, cb.yellow);

h = xlabel(<span class="string">'$A^{*}$'</span>, <span class="string">'FontSize'</span>, 16);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = ylabel(<span class="string">'$\frac{dA^{*}}{dt}$'</span>, <span class="string">'FontSize'</span>, 16, <span class="string">'rot'</span>, 0);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = legend([h1(1) h1(2) h1(3) h2 h4], {<span class="string">'Stimulus = 0.00'</span>, <span class="string">'Stimulus = 0.06'</span>,<span class="keyword">...</span>
    <span class="string">'Stimulus = 0.10'</span>, <span class="string">'Stable Fixed Point'</span>, <span class="string">'Unstable Fixed Point'</span>},<span class="keyword">...</span>
    <span class="string">'location'</span>, <span class="string">'northeast'</span>);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = title(<span class="string">'Stimulus Driven Feedback (0.4) for a First Order System'</span>,<span class="keyword">...</span>
    <span class="string">'FontSize'</span>, 12);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
</pre><img vspace="5" hspace="5" src="ps3_01.png" alt=""> <img vspace="5" hspace="5" src="ps3_02.png" alt=""> <h2>Phase Portrait and Stability Analysis of a Linear Second Order System<a name="2"></a></h2><p>The phase portrait for this linear second order system is plotted below. Setting both equations to zero and solving for the solution yields a fixed point at (0,0). This method assumes that, at the intersection of our nullclines, we should have the fixed points of the system.</p><p><img src="ps3_eq00011049619386076000.png" alt="$$\dot{x} = -3x + 2y$$"></p><p><img src="ps3_eq11847990080518632998.png" alt="$$\dot{y} = x - 2y$$"></p><p>These equations can then be represented in vector form:</p><p><img src="ps3_eq17099637191358033356.png" alt="$$&#xA;\vec{\dot{x}}=\mathbf{A}\vec{x}&#xA;$$&#xA;where $$\mathbf{A} =&#xA;\left[ {\begin{array}{*{20}c}&#xA;-3&amp;2\\&#xA;1&amp;-2&#xA;\end{array} } \right]&#xA;$$&#xA;and $$\vec{x} =&#xA;\left[ {\begin{array}{c}&#xA;x\\&#xA;y&#xA;\end{array} } \right]&#xA;$$"></p><p>The general solution to this form is <img src="ps3_eq07455695343924500792.png" alt="$x(t) = e^{\lambda{}t}$">. Substituting and simplifying this expression yields:</p><p><img src="ps3_eq18112998412255237449.png" alt="$$(\mathbf{A} - \lambda{}\mathbf{I})\vec{v} = 0$$&#xA;where $$\vec{v} \neq 0$$"></p><p>The characteristic polynomial can be found by subtracting <img src="ps3_eq08690543708263412268.png" alt="$\lambda{}\mathbf{I}$"> from <img src="ps3_eq04088523938794390934.png" alt="$\mathbf{A}$"> and taking the determinant.</p><p><img src="ps3_eq03342049986610476810.png" alt="$$det(\mathbf{A}-\lambda\mathbf{I})= (-3-\lambda)(-2-\lambda)-2=0$$"></p><p><img src="ps3_eq14752614742945927820.png" alt="$$\lambda{}^{2}+5\lambda-4=0$$"></p><p><img src="ps3_eq16989360961730940560.png" alt="$$\frac{-5\pm{}\sqrt{5^{2}-4(4)}}{2} = \lambda$$"></p><p><img src="ps3_eq12549647228983036599.png" alt="$$\lambda_{1}=-4$$"></p><p><img src="ps3_eq17537391382458254426.png" alt="$$\lambda_{2}=-1$$"></p><p>The corresponding eigenvectors can then be found using the following expression. In the phase plane, the trajectories that move in straight lines are the eigenvectors and move towards the critical point when both eigenvalues are positive.</p><p><img src="ps3_eq03170702348996857354.png" alt="$$(\mathbf{A}-\lambda_{i}\mathbf{I})\vec{v}_{i}=0$$"></p><p><img src="ps3_eq18314284119223407574.png" alt="$$&#xA;\left[ {\begin{array}{c c}&#xA;-3-\lambda_{1} &amp; 2\\&#xA;1 &amp; -2-\lambda_{1}&#xA;\end{array} } \right]&#xA;\left[ {\begin{array}{c}&#xA;v_{1}\\&#xA;v_{2}&#xA;\end{array} } \right] = 0&#xA;$$"></p><p><img src="ps3_eq09446919890035542759.png" alt="$$&#xA;\vec{v}_{1} =&#xA;\left[ {\begin{array}{c}&#xA;v_{1}\\&#xA;v_{2}&#xA;\end{array} } \right] =&#xA;\left[ {\begin{array}{c}&#xA;2\\&#xA;-1&#xA;\end{array} } \right]&#xA;$$"></p><p><img src="ps3_eq05161718115880986914.png" alt="$$&#xA;\left[ {\begin{array}{c c}&#xA;-3-\lambda_{2} &amp; 2\\&#xA;1 &amp; -2-\lambda_{2}&#xA;\end{array} } \right]&#xA;\left[ {\begin{array}{c}&#xA;v_{1}\\&#xA;v_{2}&#xA;\end{array} } \right] = 0&#xA;$$"></p><p><img src="ps3_eq11496508112718154688.png" alt="$$&#xA;\vec{v}_{2} =&#xA;\left[ {\begin{array}{c}&#xA;v_{1}\\&#xA;v_{2}&#xA;\end{array} } \right] =&#xA;\left[ {\begin{array}{c}&#xA;1\\&#xA;1&#xA;\end{array} } \right]&#xA;$$"></p><p>These eigenvectors are drawn as red and blue lines on the below phase plot and represent the unstable manifolds of the system. They conform with our hypothesis that they should be straight lines through the critical point at (0,0). Both eigenvalues are negative so the critical point is stable and is defined as an attractor. This is shown by the flow field of red arrows. It is also abvious that the major eigenvector <img src="ps3_eq03591910203080329667.png" alt="$\lambda_{1}$">, the fast eigenvector, determines the overall approach towards the critical point and the eigenvector <img src="ps3_eq18332970384824971791.png" alt="$\lambda_{2}$"> steers the solution to the critical point.</p><p>Finally, the general solution for this linear second order system is described as following:</p><p><img src="ps3_eq02073465691012337356.png" alt="$$x(t) = k_{1}e^{\lambda_{1}t}\vec{v}_{1} +&#xA;k_{2}e^{\lambda_{2}t}\vec{v}_{2}$$"></p><p><img src="ps3_eq15472436496494564586.png" alt="$$&#xA;x(t) = k_{1}e^{-4t}&#xA;\left[ {\begin{array}{c}&#xA;2\\&#xA;-1&#xA;\end{array} } \right] +&#xA;k_{2}e^{-t}&#xA;\left[ {\begin{array}{c}&#xA;1\\&#xA;1&#xA;\end{array} } \right]&#xA;$$&#xA;where $$k_{i}$$ satisfies the initial conditions. $$$$"></p><pre class="codeinput">figure(3);
hold <span class="string">on</span>;

xdom=linspace(-1,1,30);
ydom=linspace(-1,1,30);

[X,Y] = meshgrid(xdom,ydom);

U= -3 .* X + 2 .* Y;
V= X - 2 .* Y;

axis([-1, 1, -1, 1])

<span class="comment">% Vector field</span>
h0 = quiver(X, Y, U, V, <span class="string">'color'</span>, cb.turquoise);

<span class="comment">% Solutionss</span>
phase = @(~, x)[-3 * x(1) + 2 * x(2); x(1) - 2 * x(2)];

<span class="keyword">for</span> a = linspace(-1, 1, 8);
    <span class="keyword">for</span> b = linspace(-1, 1, 8);
        x0 = [a;b];
        [~, x] = ode45(phase, [0 15], x0);
        h1 = plot(x(:,1),x(:,2), <span class="string">'color'</span>, cb.grey);
    <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment">% Eigen vectors</span>
x = (-1:1:10);
s1 = -0.5 * x;
s2 = x;
h2 = plot(x, s1, <span class="string">'color'</span>, cb.green);
h3 = plot(x, s2, <span class="string">'color'</span>, cb.blue);

<span class="comment">% Nullclines</span>
x = (-1:1:10);
s1 = 1.5 * x;
s2 = 0.5 * x;
h4 = plot(x, s1, <span class="string">'color'</span>, [251/255 128/255 114/255]);
h5 = plot(x, s2, <span class="string">'color'</span>, [251/255 128/255 114/255]);

<span class="comment">% Fixed point</span>
h6 = plot(0, 0, <span class="string">'.'</span>, <span class="string">'color'</span>, <span class="string">'y'</span>, <span class="string">'MarkerSize'</span>, 20);

h = title(strcat(<span class="string">'Phase Portrait and Stability Analysis of a Linear'</span>,<span class="keyword">...</span>
                 <span class="string">' 2\textsuperscript{nd} Order System'</span>), <span class="string">'FontSize'</span>, 12);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = xlabel(<span class="string">'$x$'</span>, <span class="string">'FontSize'</span>, 16);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = ylabel(<span class="string">'$y$'</span>, <span class="string">'FontSize'</span>, 16);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
h = legend([h6 h1 h0 h4 h2 h3], {<span class="string">'Stable Fixed Point'</span>, <span class="string">'Solutions'</span>,<span class="keyword">...</span>
       <span class="string">'Vector Field'</span>, <span class="string">'Nullclines'</span>, <span class="string">'$\vec{v}$ 1'</span>, <span class="string">'$\vec{v}$ 2'</span>},<span class="keyword">...</span>
       <span class="string">'location'</span>, <span class="string">'northwest'</span>);
set(h, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>);
</pre><img vspace="5" hspace="5" src="ps3_03.png" alt=""> <h2>Complex Eigenvalues<a name="3"></a></h2><p>We will now consider this linear system:</p><p><img src="ps3_eq07146328067210940534.png" alt="$$\dot{x} = x - y$$"></p><p><img src="ps3_eq15536188160102947527.png" alt="$$\dot{y} = x + y$$"></p><p>We will solve for the eigenvalues and eigenvectors as we did when solving the linear 2nd order system above.</p><p><img src="ps3_eq02459013530775836910.png" alt="$$det(\mathbf{A}-\lambda\mathbf{I})= (-\lambda + 1)(-\lambda + 1) + 1 = 0$$"></p><p><img src="ps3_eq08224008992165229629.png" alt="$$\lambda_{1,2} = 1 \pm 1i$$"></p><p><img src="ps3_eq03170702348996857354.png" alt="$$(\mathbf{A}-\lambda_{i}\mathbf{I})\vec{v}_{i}=0$$"></p><p><img src="ps3_eq12321535816742510433.png" alt="$$&#xA;\left[ {\begin{array}{c c}&#xA;1-\lambda_{1} &amp; -1\\&#xA;1 &amp; 1-\lambda_{1}&#xA;\end{array} } \right]&#xA;\left[ {\begin{array}{c}&#xA;v_{1}\\&#xA;v_{2}&#xA;\end{array} } \right] = 0&#xA;$$"></p><p><img src="ps3_eq04277981078693298679.png" alt="$$&#xA;\vec{v}_{1} =&#xA;\left[ {\begin{array}{c}&#xA;v_{1}\\&#xA;v_{2}&#xA;\end{array} } \right] =&#xA;\left[ {\begin{array}{c}&#xA;-i\\&#xA;1&#xA;\end{array} } \right]&#xA;$$"></p><p><img src="ps3_eq07346397038602564365.png" alt="$$&#xA;\left[ {\begin{array}{c c}&#xA;1-\lambda_{2} &amp; -1\\&#xA;1 &amp; 1-\lambda_{2}&#xA;\end{array} } \right]&#xA;\left[ {\begin{array}{c}&#xA;v_{1}\\&#xA;v_{2}&#xA;\end{array} } \right] = 0&#xA;$$"></p><p><img src="ps3_eq18080506513420578356.png" alt="$$&#xA;\vec{v}_{2} =&#xA;\left[ {\begin{array}{c}&#xA;v_{1}\\&#xA;v_{2}&#xA;\end{array} } \right] =&#xA;\left[ {\begin{array}{c}&#xA;i\\&#xA;1&#xA;\end{array} } \right]&#xA;$$"></p><p>This is confirmed by the MATLAB code below.</p><p>The real-valued general solution to this set of differential equations is found as follows:</p><p><img src="ps3_eq01809218225911863264.png" alt="$$x(t) = k_{1}e^{(1 + i)t}\vec{v}_{1} + k_{2}e^{(1 - i)t}\vec{v}_{2}$$&#xA;where $$k_{i}$$ satisfies the initial conditions. $$$$"></p><p><img src="ps3_eq05667077963116319194.png" alt="$$e^{ix} = \cos{}x + i\sin{}x$$"></p><p><img src="ps3_eq07867235449464429826.png" alt="$$\vec{v}_{1} =&#xA;\left[ {\begin{array}{c}&#xA;-i\\&#xA;1&#xA;\end{array} } \right] =&#xA;\left[ {\begin{array}{c}&#xA;0\\&#xA;1&#xA;\end{array} } \right] -&#xA;i\left[ {\begin{array}{c}&#xA;1\\&#xA;0&#xA;\end{array} } \right]&#xA;$$"></p><p><img src="ps3_eq03514335344824889064.png" alt="$$\vec{v}_{2} =&#xA;\left[ {\begin{array}{c}&#xA;i\\&#xA;1&#xA;\end{array} } \right] =&#xA;\left[ {\begin{array}{c}&#xA;0\\&#xA;1&#xA;\end{array} } \right] +&#xA;i\left[ {\begin{array}{c}&#xA;1\\&#xA;0&#xA;\end{array} } \right]&#xA;$$"></p><p><img src="ps3_eq04165901134495113148.png" alt="$$&#xA;\mathbf{a} =&#xA;\left[ {\begin{array}{c}&#xA;0\\&#xA;1&#xA;\end{array} } \right],&#xA;\mathbf{b} =&#xA;\left[ {\begin{array}{c}&#xA;1\\&#xA;0&#xA;\end{array} } \right]&#xA;$$"></p><p><img src="ps3_eq06360043623588858923.png" alt="$$&#xA;x(t) = e^{t}\big[k_{1}(\cos{}t+i\sin{}t)    (\mathbf{a}-i\mathbf{b})+&#xA;                 k_{2}(\cos(-t)+i\sin{}(-t))(\mathbf{a}+i\mathbf{b})\big]&#xA;$$"></p><p><img src="ps3_eq18379451486365722523.png" alt="$$&#xA;x(t) =&#xA;e^{t}\big[k_{1}(\mathbf{a}\cos{}t+\mathbf{b}\sin{}t+&#xA;          i(\mathbf{a}\sin{}t-\mathbf{b}\cos{}t))+&#xA;      k_{2}(\mathbf{a}\cos{}t+\mathbf{b}\sin{}t-&#xA;          i(\mathbf{a}\sin{}t-\mathbf{b}\cos{}t))\big]&#xA;$$"></p><p><img src="ps3_eq18180257761700126881.png" alt="$$ C_{1} = k_{1}+k_{2}$$ and $$C_{2} = i(k_{1}+k_{2})$$"></p><p>The general solution to this system, in real terms, is:</p><p><img src="ps3_eq04793315808196819022.png" alt="$$&#xA;x(t) =&#xA;e^{t}\big[C_{1}(\mathbf{a}\cos{}t+\mathbf{b}\sin{}t)+&#xA;          C_{2}(\mathbf{a}\sin{}t-\mathbf{b}\cos{}t)\big]&#xA;$$"></p><pre class="codeinput">syms <span class="string">x</span> <span class="string">y</span>;

dxdt = x - y;
dydt = x + y;

A = equationsToMatrix(dxdt, dydt);
[V,D,~] = eig(A);

disp(D); <span class="comment">% Eigenvalues  (trace)</span>
disp(V); <span class="comment">% Eigenvectors (columns)</span>
</pre><pre class="codeoutput">[ 1 - i,     0]
[     0, 1 + i]
 
[ -i, i]
[  1, 1]
 
</pre><h2>Stability Analysis for a Non-Linear System<a name="4"></a></h2><p>To begin deriving the condition for instability as defined in Box 1 of Elowitz and Leibler (2000) we must find the non-trivial fixed point of the system and write and expression that determines the stability of that point. Using eigen analysis we will be able to represent this stability in the terms of a conditional statement. The Elowitz and Leibler (2000) model is composed of six staggered and coupled differential equations all based on the same form for protein and mRNA concentration rates. Since we are solving for a non-paramterized model and one that exists in a <i>closed loop</i> we may perform this stability analysis for two of the six coupled equations. The MATLAB code for the six coupled and staggered differential equations is found below, however, the terms for both analysis would not symplify to the expression in the paper.</p><p>First, we will find the nullclines and solve for each state variable:</p><p><img src="ps3_eq03626232200895872847.png" alt="$$\frac{dm_{i}}{dt} = -m_{i} + \frac{\alpha}{(1 + p^{n}_{j})} +&#xA;                      \alpha_{o} = 0$$"></p><p><img src="ps3_eq15653748209982452215.png" alt="$$\dot{p} = \dot{m}$$"></p><p><img src="ps3_eq14529511228479669155.png" alt="$$\frac{dp_{i}}{dt} = -\beta(p_{i} - m_{i}) = 0$$"></p><p><img src="ps3_eq09476698456045502700.png" alt="$$\dot{m} = \frac{\alpha}{(1 + \dot{p}^{n})} + \alpha_{o}$$"></p><p>Next, we express the system in matrix form at the fixed point. This is the jacobian matrix of the system at the non-trivial fixed point:</p><p><img src="ps3_eq16581252265085765150.png" alt="$$&#xA;\mathbf{J} =&#xA;\left[ {\begin{array}{*{20}c}&#xA;\frac{\partial f_{1}}{\partial m}&amp;\frac{\partial f_{1}}{\partial p}\\&#xA;\frac{\partial f_{2}}{\partial m}&amp;\frac{\partial f_{2}}{\partial p}&#xA;\end{array} } \right] =&#xA;\left[ {\begin{array}{*{20}c}&#xA;-1 &amp; X\\&#xA;\beta &amp; -\beta&#xA;\end{array} } \right]&#xA;$$ where $$X \equiv -\frac{\alpha{}n\dot{p}^{n-1}}{(1+\dot{p}^n)^2}$$ and&#xA;$$\dot{p} = \frac{\alpha}{(1 + \dot{p}^{n})} + \alpha_{o}$$"></p><p>To derive the conditional for unstabilty as expressed in the Elowitz and Liebler (2000) paper we must find the the condition when the eigenvalues have imaginary parts. The eigenvalues will have an imaginary part when the descriminant of the jacobian is negative.</p><p><img src="ps3_eq17434175618712850615.png" alt="$$\tau^{2}-4\Delta < 0$$"></p><p><img src="ps3_eq04446952689718234581.png" alt="$$(-1-\beta)^{2}-4(\beta-X\beta) < 0$$"></p><p><img src="ps3_eq11433469494180096090.png" alt="$$\frac{(\beta + 1)^{2}}{\beta} < 4(-X + 1)$$"></p><p>This expression is different than the Elowitz and Liebler (2000) expression found in Box 1:</p><p><img src="ps3_eq06423256636404374226.png" alt="$$\frac{(\beta + 1)^{2}}{\beta} < \frac{3X^{2}}{4 + 2X}$$"></p><p>Matt Manter and I emailed Michael Elowitz because we believed firmly that our calculations were correct and that there was, somewhere, and error in the paper or in our understanding of the topic. Here was his reply:</p><p><i>"There is an error in the paper whereby beta is defined two different ways (reciprocals of each other) in two places. so if you have a problem, you might try taking beta to mean 1/beta and see if that resolves it." -Michael Elowtiz (April 22 2015)</i></p><pre class="codeinput">syms <span class="string">mlacl</span> <span class="string">mtetR</span> <span class="string">mcl</span> <span class="string">placl</span> <span class="string">ptetR</span> <span class="string">pcl</span> <span class="string">a</span> <span class="string">ao</span> <span class="string">b</span> <span class="string">n</span> <span class="string">X</span> <span class="string">p</span> <span class="string">m</span>;

<span class="comment">% 6 coupled staggered differential equations</span>
dmlacldt = -mlacl + (a / (1 + pcl^n)) + ao;
dmtetRdt = -mtetR + (a / (1 + placl^n)) + ao;
dmcldt = -mcl + (a / (1 + ptetR^n)) + ao;
dplacldt = -b * (placl - mlacl);
dptetRdt = -b * (ptetR - mtetR);
dpcldt = -b * (pcl - mcl);

<span class="comment">% Jacbobian for the above system</span>
j = jacobian([dmlacldt, dplacldt, dmtetRdt, dptetRdt, dmcldt, dpcldt],<span class="keyword">...</span>
             [mlacl, placl, mtetR, ptetR, mcl,pcl]);

<span class="comment">% Replaces all partial function to partial p with X. Lose subscripts.</span>
j = subs(j, [-(a*n*placl^(n - 1))/(placl^n + 1)^2,<span class="keyword">...</span>
             -(a*n*ptetR^(n - 1))/(ptetR^n + 1)^2,<span class="keyword">...</span>
             -(a*n*pcl^(n - 1))/(pcl^n + 1)^2],<span class="keyword">...</span>
             [X, X, X]);

disp(simplify(trace(j)^2-4*det(j) &lt; 0)); <span class="comment">% Cannot simplify to paper expression</span>

<span class="comment">% 2 Coupled differential equations</span>
dmdt = -m + (a / (1 + p^n)) + ao;
dpdt = -b * (p - m);

<span class="comment">% Jacobian for the above system</span>
j = jacobian([dmdt, dpdt], [m p]);
j = subs(j, -(a*n*p^(n - 1))/(p^n + 1)^2, X);

disp(simplify(trace(j)^2-4*det(j) &lt; 0)); <span class="comment">% Cannot simplify to paper expression</span>
disp(simplify(-trace(j) + trace(j)^2-4*det(j) == 0));
disp(simplify(-trace(j) - trace(j)^2-4*det(j) == 0));
</pre><pre class="codeoutput">4*b^3*(X^3 - 1) + (3*b + 3)^2 &lt; 0
 
b*(4*X + b - 2) &lt; -1
 
b^2 + 4*X*b + 2 == b
 
b == 0 | 4*X == b + 5
 
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2014b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Problem Set 3
%  Clint Valentine
%  April 22th 2015
%  Biomolecular Control and Dynamics
%  Prof. Anand Asthagiri
%% Bistability and Phase Portrait for a First-Order System
%
% The phase portrait of this single state variable system contains a
% positive feedback as the production of $A^{*}$ will encourage the
% production of more $A^{*}$ from remaining $A$. The phase portrait will
% show how this system will move through time. We will plot the entire
% system in a phase plane $\frac{dA^{*}}{dt}$ vs. $A^{*}$ and whenever the
% system intersects the y-axis, there is a fixed point.
%
% $$
% \frac{dA^{*}}{dt} = \big(stimulus + f\frac{A^{*n}}{K^{n} + A^{*n}}\big)
% (A_{T} - A^{*}) - k_{i}A^{*}
% $$
%
% The following code and plots show the system for three stimulus values
% and two feedback values. The non-trivial fixed points where plotted.
% The qualitative change in the system for a
% feedback level of $0.4$ compared to $0.3$ is that there now exists two
% stable fixed points in the system with no stimulus. This is significant
% because a system that begins with a higher level of $A^{*}$ can maintain 
% $A^{*}$ production with zero stimulus.
%
% Another qualitative characteristic that appears is the exaggerated slopes
% in the phase plane. The rate of $A^{*}$ in the higher feedback level
% system works harder to maintain the stable fixed points.

% Create colorbrewer for better plotting. Download hex2rgb.m.
cb.black = hex2rgb('#000000', 1);cb.grey = hex2rgb('#999999', 1);
cb.orange  = hex2rgb('#E69F00', 1);cb.turquoise = hex2rgb('#56B4E9', 1);
cb.green = hex2rgb('#009E73', 1);cb.yellow = hex2rgb('#F0E442', 1);
cb.blue = hex2rgb('#0072B2', 1);cb.red = hex2rgb('#D55E00', 1);

syms a stimulus;

n = 7.0;
K = 0.5;
At = 1.0;
ki = 0.2;
f = [0.3, 0.4];
stim = [0, 0.06, 0.1];

figure(1);
hold on;
axis('on');
grid('on');

axis([0, 1, -0.2, 0.15])

yL = xlim;
line(yL, [0 0], 'color', cb.grey);  % x-axis

x = linspace(0, 1, 1000);
feedback = @(stimulus, x) (stimulus(1) + f(1) .* (x.^n) ./ (K^n + x.^n))...
    .* (At - x) - (ki .* x);
eqn = (stimulus + f(1) * (a^n) / (K^n + a^n)) * (At - a) - (ki * a) == 0;

y1 = feedback(stim(1), x);
y2 = feedback(stim(2), x);
y3 = feedback(stim(3), x);

roots1 = solve(subs(eqn, stimulus, stim(1)), 'a');
roots2 = solve(subs(eqn, stimulus, stim(2)), 'a');
roots3 = solve(subs(eqn, stimulus, stim(3)), 'a');

h1 = plot(x, y1, x, y2, x, y3);
h2 = plot(roots1(1), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);
h3 = plot(vpa(roots2(2)), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);
h4 = plot(vpa(roots2(3)), 0, 'ro', 'MarkerFaceColor', 'none',...
    'MarkerEdgeColor', cb.yellow);
h5 = plot(vpa(roots2(4)), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);
h6 = plot(vpa(roots3(2)), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);

h = xlabel('$A^{*}$', 'FontSize', 16);
set(h, 'Interpreter', 'latex');
h = ylabel('$\frac{dA^{*}}{dt}$', 'FontSize', 16, 'rot', 0);
set(h, 'Interpreter', 'latex');
h = legend([h1(1) h1(2) h1(3) h2 h4], {'Stimulus = 0.00', 'Stimulus = 0.06',...
    'Stimulus = 0.10', 'Stable Fixed Point', 'Unstable Fixed Point'},...
    'location', 'northeast');
set(h, 'Interpreter', 'latex');
h = title('Stimulus Driven Feedback (0.3) for a First Order System',...
    'FontSize', 12);
set(h, 'Interpreter', 'latex');


figure(2);
hold on;
axis('on');
grid('on');

yL = xlim;
line(yL, [0 0], 'color', cb.grey);  % x-axis

x = linspace(0, 1, 1000);
feedback = @(stimulus, x) (stimulus(1) + f(2) .* (x.^n) ./...
    (K^n + x.^n)) .* (At - x) - (ki .* x);
eqn = (stimulus + f(2) * (a^n) / (K^n + a^n)) * (At - a) - (ki * a) == 0;

y1 = feedback(stim(1), x);
y2 = feedback(stim(2), x);
y3 = feedback(stim(3), x);

roots1 = solve(subs(eqn, stimulus, stim(1)), 'a');
roots2 = solve(subs(eqn, stimulus, stim(2)), 'a');
roots3 = solve(subs(eqn, stimulus, stim(3)), 'a');

h1 = plot(x, y1, x, y2, x, y3);
h2 = plot(roots1(1), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);
h3 = plot(vpa(roots2(2)), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);
h4 = plot(vpa(roots2(3)), 0, 'ro', 'MarkerFaceColor', 'none',...
    'MarkerEdgeColor', cb.yellow);
h5 = plot(vpa(roots1(2)), 0, 'ro', 'MarkerFaceColor', 'none',...
    'MarkerEdgeColor', cb.yellow);
h6 = plot(vpa(roots1(4)), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);
h7 = plot(vpa(roots2(4)), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);
h8 = plot(vpa(roots3(2)), 0, 'ro', 'MarkerFaceColor', cb.yellow,...
    'MarkerEdgeColor', cb.yellow);

h = xlabel('$A^{*}$', 'FontSize', 16);
set(h, 'Interpreter', 'latex');
h = ylabel('$\frac{dA^{*}}{dt}$', 'FontSize', 16, 'rot', 0);
set(h, 'Interpreter', 'latex');
h = legend([h1(1) h1(2) h1(3) h2 h4], {'Stimulus = 0.00', 'Stimulus = 0.06',...
    'Stimulus = 0.10', 'Stable Fixed Point', 'Unstable Fixed Point'},...
    'location', 'northeast');
set(h, 'Interpreter', 'latex');
h = title('Stimulus Driven Feedback (0.4) for a First Order System',...
    'FontSize', 12);
set(h, 'Interpreter', 'latex');
%% Phase Portrait and Stability Analysis of a Linear Second Order System
% The phase portrait for this linear second order system is plotted below.
% Setting both equations to zero and solving for the solution yields a
% fixed point at (0,0). This method assumes that, at the intersection of
% our nullclines, we should have the fixed points of the system.
%
% $$\dot{x} = -3x + 2y$$
%
% $$\dot{y} = x - 2y$$
%
% These equations can then be represented in vector form:
%
% $$
% \vec{\dot{x}}=\mathbf{A}\vec{x}
% $$
% where $$\mathbf{A} =
% \left[ {\begin{array}{*{20}c}
% -3&2\\
% 1&-2
% \end{array} } \right]
% $$
% and $$\vec{x} =
% \left[ {\begin{array}{c}
% x\\
% y
% \end{array} } \right]
% $$
%
% The general solution to this form is $x(t) = e^{\lambda{}t}$.
% Substituting and simplifying this expression yields:
%
% $$(\mathbf{A} - \lambda{}\mathbf{I})\vec{v} = 0$$
% where $$\vec{v} \neq 0$$
%
% The characteristic polynomial can be found by subtracting
% $\lambda{}\mathbf{I}$ from $\mathbf{A}$ and taking the determinant.
%
% $$det(\mathbf{A}-\lambda\mathbf{I})= (-3-\lambda)(-2-\lambda)-2=0$$
%
% $$\lambda{}^{2}+5\lambda-4=0$$
%
% $$\frac{-5\pm{}\sqrt{5^{2}-4(4)}}{2} = \lambda$$
%
% $$\lambda_{1}=-4$$
%
% $$\lambda_{2}=-1$$
%
% The corresponding eigenvectors can then be found using the following
% expression. In the phase plane, the trajectories that move in straight
% lines are the eigenvectors and move towards the critical point when both
% eigenvalues are positive.
%
% $$(\mathbf{A}-\lambda_{i}\mathbf{I})\vec{v}_{i}=0$$
%
%
%
% $$
% \left[ {\begin{array}{c c}
% -3-\lambda_{1} & 2\\
% 1 & -2-\lambda_{1}
% \end{array} } \right]
% \left[ {\begin{array}{c}
% v_{1}\\
% v_{2}
% \end{array} } \right] = 0
% $$
%
% $$
% \vec{v}_{1} =
% \left[ {\begin{array}{c}
% v_{1}\\
% v_{2}
% \end{array} } \right] =
% \left[ {\begin{array}{c}
% 2\\
% -1
% \end{array} } \right]
% $$
%
% $$
% \left[ {\begin{array}{c c}
% -3-\lambda_{2} & 2\\
% 1 & -2-\lambda_{2}
% \end{array} } \right]
% \left[ {\begin{array}{c}
% v_{1}\\
% v_{2}
% \end{array} } \right] = 0
% $$
%
% $$
% \vec{v}_{2} =
% \left[ {\begin{array}{c}
% v_{1}\\
% v_{2}
% \end{array} } \right] =
% \left[ {\begin{array}{c}
% 1\\
% 1
% \end{array} } \right]
% $$
%
% These eigenvectors are drawn as red and blue lines on the below phase
% plot and represent the unstable manifolds of the system. They conform
% with our hypothesis that they should be straight lines
% through the critical point at (0,0). Both eigenvalues are negative so the
% critical point is stable and is defined as an attractor. This is shown by
% the flow field of red arrows. It is also abvious that the major 
% eigenvector $\lambda_{1}$, the fast eigenvector, determines the overall
% approach towards the critical point and the eigenvector $\lambda_{2}$
% steers the solution to the critical point.
%
% Finally, the general solution for this linear second order system is
% described as following:
%
% $$x(t) = k_{1}e^{\lambda_{1}t}\vec{v}_{1} +
% k_{2}e^{\lambda_{2}t}\vec{v}_{2}$$
%
% $$
% x(t) = k_{1}e^{-4t}
% \left[ {\begin{array}{c}
% 2\\
% -1
% \end{array} } \right] +
% k_{2}e^{-t}
% \left[ {\begin{array}{c}
% 1\\
% 1
% \end{array} } \right]
% $$
% where $$k_{i}$$ satisfies the initial conditions. $$$$

figure(3);
hold on;

xdom=linspace(-1,1,30);
ydom=linspace(-1,1,30);

[X,Y] = meshgrid(xdom,ydom);

U= -3 .* X + 2 .* Y;
V= X - 2 .* Y;

axis([-1, 1, -1, 1])

% Vector field
h0 = quiver(X, Y, U, V, 'color', cb.turquoise);

% Solutionss
phase = @(~, x)[-3 * x(1) + 2 * x(2); x(1) - 2 * x(2)];

for a = linspace(-1, 1, 8);
    for b = linspace(-1, 1, 8);
        x0 = [a;b];
        [~, x] = ode45(phase, [0 15], x0);
        h1 = plot(x(:,1),x(:,2), 'color', cb.grey);
    end
end

% Eigen vectors
x = (-1:1:10);
s1 = -0.5 * x;
s2 = x;
h2 = plot(x, s1, 'color', cb.green);
h3 = plot(x, s2, 'color', cb.blue);

% Nullclines
x = (-1:1:10);
s1 = 1.5 * x;
s2 = 0.5 * x;
h4 = plot(x, s1, 'color', [251/255 128/255 114/255]);
h5 = plot(x, s2, 'color', [251/255 128/255 114/255]);

% Fixed point
h6 = plot(0, 0, '.', 'color', 'y', 'MarkerSize', 20);

h = title(strcat('Phase Portrait and Stability Analysis of a Linear',...
                 ' 2\textsuperscript{nd} Order System'), 'FontSize', 12);
set(h, 'Interpreter', 'latex');
h = xlabel('$x$', 'FontSize', 16);
set(h, 'Interpreter', 'latex');
h = ylabel('$y$', 'FontSize', 16);
set(h, 'Interpreter', 'latex');
h = legend([h6 h1 h0 h4 h2 h3], {'Stable Fixed Point', 'Solutions',...
       'Vector Field', 'Nullclines', '$\vec{v}$ 1', '$\vec{v}$ 2'},...
       'location', 'northwest');
set(h, 'Interpreter', 'latex');
%% Complex Eigenvalues
% We will now consider this linear system:
%
% $$\dot{x} = x - y$$
%
% $$\dot{y} = x + y$$
%
% We will solve for the eigenvalues and eigenvectors as we did when solving
% the linear 2nd order system above.
%
% $$det(\mathbf{A}-\lambda\mathbf{I})= (-\lambda + 1)(-\lambda + 1) + 1 = 0$$
%
% $$\lambda_{1,2} = 1 \pm 1i$$
%
% $$(\mathbf{A}-\lambda_{i}\mathbf{I})\vec{v}_{i}=0$$
%
% $$
% \left[ {\begin{array}{c c}
% 1-\lambda_{1} & -1\\
% 1 & 1-\lambda_{1}
% \end{array} } \right]
% \left[ {\begin{array}{c}
% v_{1}\\
% v_{2}
% \end{array} } \right] = 0
% $$
%
% $$
% \vec{v}_{1} =
% \left[ {\begin{array}{c}
% v_{1}\\
% v_{2}
% \end{array} } \right] =
% \left[ {\begin{array}{c}
% -i\\
% 1
% \end{array} } \right]
% $$
%
% $$
% \left[ {\begin{array}{c c}
% 1-\lambda_{2} & -1\\
% 1 & 1-\lambda_{2}
% \end{array} } \right]
% \left[ {\begin{array}{c}
% v_{1}\\
% v_{2}
% \end{array} } \right] = 0
% $$
%
% $$
% \vec{v}_{2} =
% \left[ {\begin{array}{c}
% v_{1}\\
% v_{2}
% \end{array} } \right] =
% \left[ {\begin{array}{c}
% i\\
% 1
% \end{array} } \right]
% $$
%
% This is confirmed by the MATLAB code below.
% 
% The real-valued general solution to this set of differential equations is
% found as follows:
%
% $$x(t) = k_{1}e^{(1 + i)t}\vec{v}_{1} + k_{2}e^{(1 - i)t}\vec{v}_{2}$$
% where $$k_{i}$$ satisfies the initial conditions. $$$$
%
% $$e^{ix} = \cos{}x + i\sin{}x$$
%
% $$\vec{v}_{1} =
% \left[ {\begin{array}{c}
% -i\\
% 1
% \end{array} } \right] =
% \left[ {\begin{array}{c}
% 0\\
% 1
% \end{array} } \right] -
% i\left[ {\begin{array}{c}
% 1\\
% 0
% \end{array} } \right]
% $$
%
% $$\vec{v}_{2} =
% \left[ {\begin{array}{c}
% i\\
% 1
% \end{array} } \right] =
% \left[ {\begin{array}{c}
% 0\\
% 1
% \end{array} } \right] +
% i\left[ {\begin{array}{c}
% 1\\
% 0
% \end{array} } \right]
% $$
%
% $$
% \mathbf{a} =
% \left[ {\begin{array}{c}
% 0\\
% 1
% \end{array} } \right], 
% \mathbf{b} =
% \left[ {\begin{array}{c}
% 1\\
% 0
% \end{array} } \right]
% $$
%
% $$
% x(t) = e^{t}\big[k_{1}(\cos{}t+i\sin{}t)    (\mathbf{a}-i\mathbf{b})+
%                  k_{2}(\cos(-t)+i\sin{}(-t))(\mathbf{a}+i\mathbf{b})\big]
% $$
%
% $$
% x(t) =
% e^{t}\big[k_{1}(\mathbf{a}\cos{}t+\mathbf{b}\sin{}t+
%           i(\mathbf{a}\sin{}t-\mathbf{b}\cos{}t))+
%       k_{2}(\mathbf{a}\cos{}t+\mathbf{b}\sin{}t-
%           i(\mathbf{a}\sin{}t-\mathbf{b}\cos{}t))\big]
% $$
%
% $$ C_{1} = k_{1}+k_{2}$$ and $$C_{2} = i(k_{1}+k_{2})$$
%
% The general solution to this system, in real terms, is:
%
% $$
% x(t) =
% e^{t}\big[C_{1}(\mathbf{a}\cos{}t+\mathbf{b}\sin{}t)+
%           C_{2}(\mathbf{a}\sin{}t-\mathbf{b}\cos{}t)\big]
% $$

syms x y;

dxdt = x - y;
dydt = x + y;

A = equationsToMatrix(dxdt, dydt);
[V,D,~] = eig(A);

disp(D); % Eigenvalues  (trace)
disp(V); % Eigenvectors (columns)

%% Stability Analysis for a Non-Linear System
%
% To begin deriving the condition for instability as defined in Box 1 of
% Elowitz and Leibler (2000) we must find the non-trivial fixed point
% of the system and write and expression that determines the stability of
% that point. Using eigen analysis we will be able to represent this
% stability in the terms of a conditional statement. The Elowitz and
% Leibler (2000) model is composed of six staggered and coupled
% differential equations all based on the same form for protein and mRNA
% concentration rates. Since we are solving for a non-paramterized model
% and one that exists in a _closed loop_ we may perform this stability
% analysis for two of the six coupled equations. The MATLAB code for the
% six coupled and staggered differential equations is found below, however,
% the terms for both analysis would not symplify to the expression in the
% paper.
%
% First, we will find the nullclines and solve for each state variable:
%
% $$\frac{dm_{i}}{dt} = -m_{i} + \frac{\alpha}{(1 + p^{n}_{j})} +
%                       \alpha_{o} = 0$$
%
% $$\dot{p} = \dot{m}$$
%
% $$\frac{dp_{i}}{dt} = -\beta(p_{i} - m_{i}) = 0$$
%
% $$\dot{m} = \frac{\alpha}{(1 + \dot{p}^{n})} + \alpha_{o}$$
%
% Next, we express the system in matrix form at the fixed point. This is
% the jacobian matrix of the system at the non-trivial fixed point:
%
% $$
% \mathbf{J} =
% \left[ {\begin{array}{*{20}c}
% \frac{\partial f_{1}}{\partial m}&\frac{\partial f_{1}}{\partial p}\\
% \frac{\partial f_{2}}{\partial m}&\frac{\partial f_{2}}{\partial p}
% \end{array} } \right] =
% \left[ {\begin{array}{*{20}c}
% -1 & X\\
% \beta & -\beta
% \end{array} } \right]
% $$ where $$X \equiv -\frac{\alpha{}n\dot{p}^{n-1}}{(1+\dot{p}^n)^2}$$ and
% $$\dot{p} = \frac{\alpha}{(1 + \dot{p}^{n})} + \alpha_{o}$$
%
% To derive the conditional for unstabilty as expressed in the Elowitz and
% Liebler (2000) paper we must find the the condition when the eigenvalues
% have imaginary parts. The eigenvalues will have an imaginary part when
% the descriminant of the jacobian is negative.
%
% $$\tau^{2}-4\Delta < 0$$
%
% $$(-1-\beta)^{2}-4(\beta-X\beta) < 0$$
%
% $$\frac{(\beta + 1)^{2}}{\beta} < 4(-X + 1)$$
%
% This expression is different than the Elowitz and Liebler (2000)
% expression found in Box 1:
%
% $$\frac{(\beta + 1)^{2}}{\beta} < \frac{3X^{2}}{4 + 2X}$$
%
% Matt Manter and I emailed Michael Elowitz because we believed firmly that
% our calculations were correct and that there was, somewhere, and error in
% the paper or in our understanding of the topic. Here was his reply:
%
% _"There is an error in the paper whereby beta is defined two different
% ways (reciprocals of each other) in two places. so if you have a problem,
% you might try taking beta to mean 1/beta and see if that resolves it." 
% -Michael Elowtiz (April 22 2015)_
syms mlacl mtetR mcl placl ptetR pcl a ao b n X p m;

% 6 coupled staggered differential equations
dmlacldt = -mlacl + (a / (1 + pcl^n)) + ao;
dmtetRdt = -mtetR + (a / (1 + placl^n)) + ao;
dmcldt = -mcl + (a / (1 + ptetR^n)) + ao;
dplacldt = -b * (placl - mlacl);
dptetRdt = -b * (ptetR - mtetR);
dpcldt = -b * (pcl - mcl);

% Jacbobian for the above system
j = jacobian([dmlacldt, dplacldt, dmtetRdt, dptetRdt, dmcldt, dpcldt],...
             [mlacl, placl, mtetR, ptetR, mcl,pcl]);

% Replaces all partial function to partial p with X. Lose subscripts.
j = subs(j, [-(a*n*placl^(n - 1))/(placl^n + 1)^2,...
             -(a*n*ptetR^(n - 1))/(ptetR^n + 1)^2,...
             -(a*n*pcl^(n - 1))/(pcl^n + 1)^2],...
             [X, X, X]);

disp(simplify(trace(j)^2-4*det(j) < 0)); % Cannot simplify to paper expression

% 2 Coupled differential equations
dmdt = -m + (a / (1 + p^n)) + ao;
dpdt = -b * (p - m);

% Jacobian for the above system
j = jacobian([dmdt, dpdt], [m p]);
j = subs(j, -(a*n*p^(n - 1))/(p^n + 1)^2, X);

disp(simplify(trace(j)^2-4*det(j) < 0)); % Cannot simplify to paper expression
disp(simplify(-trace(j) + trace(j)^2-4*det(j) == 0));
disp(simplify(-trace(j) - trace(j)^2-4*det(j) == 0));       

##### SOURCE END #####
--></body></html>